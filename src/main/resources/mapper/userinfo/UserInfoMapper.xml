<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.review.shop.repository.userinfo.UserInfoMapper">


    <select id="findById" resultType="com.review.shop.dto.userinfo.UserInfoResponseDTO">
        SELECT
            USER_ID as user_id, NAME, NICKNAME, EMAIL, PHONE_NUMBER as phoneNumber, POINT,
            BAUMANN_ID as baumann_id, CREATED_AT as createdAt, UPDATED_AT as updatedAt
        FROM USER_TABLE
        WHERE USER_ID = #{user_id}
          AND DELETED_AT IS NULL
    </select>

    <update id="updateUser">
        UPDATE USER_TABLE
        <set>
            <if test="updateDTO.name != null">NAME = #{updateDTO.name},</if>
            <if test="updateDTO.nickname != null">NICKNAME = #{updateDTO.nickname},</if>
            <if test="updateDTO.phoneNumber != null">PHONE_NUMBER = #{updateDTO.phoneNumber},</if>
            <if test="updateDTO.password != null">PASSWORD = #{updateDTO.password},</if>
            UPDATED_AT = SYSDATE
        </set>
        WHERE USER_ID = #{user_id}
    </update>

    <update id="deleteUser">
        UPDATE USER_TABLE
        SET DELETED_AT = SYSDATE
        WHERE USER_ID = #{user_id}
    </update>


</mapper>
