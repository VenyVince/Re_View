<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.review.shop.repository.userinfo.UserInfoMapper">


    <select id="getInfo" resultType="com.review.shop.dto.userinfo.GetUserInfoDTO">
        SELECT
            USER_ID as user_id, NAME, NICKNAME, PHONE_NUMBER as phoneNumber,
            BAUMANN_ID as baumann_id, UPDATED_AT as updatedAt
        FROM USER_TABLE
        WHERE USER_ID = #{user_id}
          AND DELETED_AT IS NULL
    </select>

    <update id="updateInfo">
        UPDATE USER_TABLE
        <set>
            <if test="updateDTO.nickname != null">NICKNAME = #{updateDTO.nickname},</if>
            <if test="updateDTO.phoneNumber != null">PHONE_NUMBER = #{updateDTO.phoneNumber},</if>
            <if test="updateDTO.password != null">PASSWORD = #{updateDTO.password},</if>
            <if test="updateDTO.baumann_id != null">BAUMANN = #{updateDTO.Baumann},</if>
            UPDATED_AT = SYSDATE
        </set>
        WHERE USER_ID = #{user_id}
    </update>

    <update id="deleteUser">
        UPDATE USER_TABLE
        SET DELETED_AT = SYSDATE
        WHERE USER_ID = #{user_id}
    </update>


</mapper>
